// Generated by CoffeeScript 2.5.1
'use strict';
var remove, table;

table = document.querySelector('#feedback-table');

import {
  paginate
} from '/js/console/pages.js';

import * as notify from '/js/console/notifications.js';

remove = function(element) {
  return element.parentNode.removeChild(element);
};

addEventListener('load', async function() {
  var emailCell, feedback, feedbacks, i, len, messageCell, nameCell, res, tableRow;
  res = (await fetch('/console/api/v0.1/feedback/').catch(function() {
    return notify.tell('Download error', 'Could not download feedback. Please check your internet connection.', 'error');
  }));
  if (res.status === 429) {
    return notify.tell('Please wait', 'You have submitted too many requests and need to wait to continue', 'error');
  } else if (res.ok) {
    feedbacks = (await res.json());
    for (i = 0, len = feedbacks.length; i < len; i++) {
      feedback = feedbacks[i];
      tableRow = document.createElement('tr');
      table.appendChild(tableRow);
      nameCell = document.createElement('td');
      nameCell.innerHTML = feedback.name || '[Not provided]';
      tableRow.appendChild(nameCell);
      emailCell = document.createElement('td');
      emailCell.innerHTML = feedback.email || '[Not provided]';
      tableRow.appendChild(emailCell);
      messageCell = document.createElement('td');
      messageCell.innerHTML = feedback.message;
      tableRow.appendChild(messageCell);
    }
    return paginate();
  }
});

//# sourceMappingURL=feedback.js.map
