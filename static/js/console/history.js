// Generated by CoffeeScript 2.5.1
var addVersion, versionTable;

versionTable = document.querySelector('#version-table');

import {
  paginate
} from '/js/console/pages.js';

import * as notify from '/js/console/notifications.js';

addVersion = function(version) {
  var i, len, log, ref, results, tableRow, versionCell, versionLogCell, versionLogText;
  tableRow = document.createElement('tr');
  versionTable.appendChild(tableRow);
  versionCell = document.createElement('td');
  versionCell.innerHTML = version.version;
  tableRow.appendChild(versionCell);
  versionLogCell = document.createElement('td');
  tableRow.appendChild(versionLogCell);
  ref = version.logs;
  results = [];
  for (i = 0, len = ref.length; i < len; i++) {
    log = ref[i];
    versionLogText = document.createElement('p');
    versionLogText.innerHTML = log;
    results.push(versionLogCell.appendChild(versionLogText));
  }
  return results;
};

addEventListener('load', async function() {
  var i, len, res, version, versions;
  res = (await fetch('/console/api/v0.1/versions').catch(function() {
    return notify.tell('Download error', 'Could not download version list. Please check your internet connection.', 'error');
  }));
  if (res.status === 429) {
    return notify.tell('Please wait', 'You have submitted too many requests and need to wait to continue', 'error');
  } else if (res.ok) {
    versions = (await res.json());
    for (i = 0, len = versions.length; i < len; i++) {
      version = versions[i];
      addVersion(version);
    }
    return paginate({
      pageSize: 8
    });
  }
});

//# sourceMappingURL=history.js.map
